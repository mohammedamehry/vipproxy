<!DOCTYPE html>
<html>
<head>
    <title>HLS Proxy Test</title>
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        body { font-family: sans-serif; max-width: 800px; margin: 2rem auto; text-align: center; background: #222; color: #fff; }
        video { width: 100%; max-width: 800px; margin-top: 1rem; border: 1px solid #444; }
        .controls { margin: 1rem 0; }
        button { padding: 0.5rem 1rem; cursor: pointer; background: #e50914; color: white; border: none; font-weight: bold; }
    </style>
</head>
<body>
    <h1>Proxy Stream Test</h1>
    <div id="status">Initializing...</div>
    <video id="video" controls muted autoplay></video>
    
    <script>
        var video = document.getElementById('video');
        var statusDiv = document.getElementById('status');
        
        // The proxy URL with target stream and headers
        var streamUrl = '/proxy?url=https://gg.poocloud.in/epl_cry/tracks-v1a1/mono.ts.m3u8&h_origin=https://embedsports.top&h_referer=https://embedsports.top/';

        if (Hls.isSupported()) {
            var hls = new Hls({
                debug: true // Enable debug logs
            });
            hls.loadSource(streamUrl);
            hls.attachMedia(video);
            hls.on(Hls.Events.MANIFEST_PARSED, function() {
                statusDiv.innerText = "Manifest parsed, attempting to play...";
                video.play().catch(e => console.error("Auto-play failed:", e));
            });
            hls.on(Hls.Events.ERROR, function (event, data) {
                console.error("HLS Error:", data);
                statusDiv.innerText = "Error: " + data.type + " - " + data.details;
            });
        }
        else if (video.canPlayType('application/vnd.apple.mpegurl')) {
            video.src = streamUrl;
            video.addEventListener('loadedmetadata', function() {
                video.play();
            });
        } else {
            statusDiv.innerText = "HLS not supported in this browser.";
        }
    </script>
</body>
</html>
